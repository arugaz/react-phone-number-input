{"version":3,"file":"ReactHookFormInput.js","names":["ReactHookFormInput","ref","Component","name","defaultValue","shouldUnregister","control","rules","onChange_","onChange","onBlur_","onBlur","rest","internalRef","useRef","setRef","useCallback","instance","current","undefined","renderInputComponent","restReactHookFormControlledFieldProps","useImperativeHandle","focus","setComponentRef","onChangeCombined","value","onBlurCombined","event","onFocus","props","field","React","forwardRef","propTypes","PropTypes","elementType","isRequired","string","bool","object","func"],"sources":["../../source/react-hook-form/ReactHookFormInput.js"],"sourcesContent":["import React, { useRef, useCallback, useImperativeHandle } from 'react'\nimport { Controller } from 'react-hook-form'\nimport PropTypes from 'prop-types'\n\nlet ReactHookFormInput = ({\n  Component,\n  name,\n  defaultValue,\n  shouldUnregister,\n  control,\n  rules,\n  onChange: onChange_,\n  onBlur: onBlur_,\n  ...rest\n}, ref) => {\n  const internalRef = useRef()\n\n  const setRef = useCallback((instance) => {\n    internalRef.current = instance\n    if (ref) {\n      if (typeof ref === 'function') {\n        ref(instance)\n      } else {\n        ref.current = instance\n      }\n    }\n  }, [ref])\n\n  // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n  // https://github.com/react-hook-form/react-hook-form/issues/2990\n  defaultValue = defaultValue === undefined ? null : defaultValue\n\n  const renderInputComponent = ({\n    ref,\n    onChange,\n    onBlur,\n    // `restReactHookFormControlledFieldProps` contain properties like `name` and `value`.\n    // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n    ...restReactHookFormControlledFieldProps\n  }) => {\n    // Setting `ref` passed by `react-hook-form` results in a bug:\n    // when an initial value is defined (example: \"+78005553535\")\n    // it seems to be set directly on the `ref`d `<input/>`\n    // by `react-hook-form` and the result is a non-formatted\n    // \"+78005553535\" initial value in the `<input/>`.\n    //\n    // To work around that bug, a fake `ref` is assigned,\n    // so that it could only `.focus()` it and no more.\n    //\n    // `useImperativeHandle()` hook seems to allow `ref` being `undefined`.\n    //\n    // if (ref) {\n      useImperativeHandle(ref, () => ({\n        focus() {\n          internalRef.current.focus()\n        }\n      }))\n    // }\n\n    const setComponentRef = useCallback((instance) => {\n      setRef(instance)\n      // if (ref) {\n      //   if (typeof ref === 'function') {\n      //     ref(instance)\n      //   } else {\n      //     ref.current = instance\n      //   }\n      // }\n    }, [ref, setRef])\n\n    // This function may not work correctly when `defaultValues` are set for the input\n    // and the user clears the input value manually: the default value may re-appear as a result.\n    // https://github.com/catamphetamine/react-phone-number-input/issues/405#issuecomment-1295885201\n    const onChangeCombined = useCallback((value) => {\n      // `react-hook-form` doesn't know how to properly handle `undefined` values.\n      // https://github.com/react-hook-form/react-hook-form/issues/2990\n      if (value === undefined) {\n        value = null\n      }\n      onChange(value)\n      if (onChange_) {\n        onChange_(value)\n      }\n    }, [\n      onChange,\n      onChange_\n    ])\n\n    const onBlurCombined = useCallback((event) => {\n      onBlur(event)\n      if (onBlur_) {\n        onBlur_(event)\n      }\n    }, [\n      onBlur,\n      onBlur_\n    ])\n\n    return (\n      <Component\n        {...rest}\n        {...restReactHookFormControlledFieldProps}\n        ref={setComponentRef}\n        onChange={onChangeCombined}\n        onBlur={onBlurCombined}/>\n    )\n  }\n\n  // `react-hook-form@7` no longer accepts `onFocus` property.\n  // Since this component can be used with both `v6` and `v7`,\n  // the `onFocus` property is left here.\n  const onFocus = useCallback(() => {\n    // internalRef.current.disabled = false\n    internalRef.current.focus()\n  }, [])\n\n  return (\n    <Controller\n      control={control}\n      name={name}\n      defaultValue={defaultValue}\n      shouldUnregister={shouldUnregister}\n      rules={rules}\n      onFocus={onFocus}\n      render={(props) => {\n        // Differentiate between `react-hook-form@6` and `react-hook-form@7`.\n        // https://react-hook-form.com/migrate-v6-to-v7/\n        // https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/57\n        // `props` (before v7) and `props.fields` (in v7) contain properties like:\n        // `ref`, `name`, `value`, `onChange`, `onBlur`.\n        // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n        return renderInputComponent(props.field || props)\n      }}/>\n  )\n}\n\nReactHookFormInput = React.forwardRef(ReactHookFormInput)\n\nReactHookFormInput.propTypes = {\n  Component: PropTypes.elementType.isRequired,\n  name: PropTypes.string.isRequired,\n  defaultValue: PropTypes.string,\n  // A quote from `react-hook-form`:\n  // Without `shouldUnregister: true`, an input value would be retained when input is removed.\n  // Setting `shouldUnregister: true` makes the form behave more closer to native.\n  shouldUnregister: PropTypes.bool,\n  control: PropTypes.object.isRequired,\n  rules: PropTypes.object,\n  onChange: PropTypes.func,\n  onBlur: PropTypes.func\n}\n\nexport default ReactHookFormInput"],"mappings":"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"}