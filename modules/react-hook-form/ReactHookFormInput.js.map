{"version":3,"file":"ReactHookFormInput.js","names":["React","useRef","useCallback","useImperativeHandle","Controller","PropTypes","ReactHookFormInput","ref","Component","name","defaultValue","shouldUnregister","control","rules","onChange_","onChange","onBlur_","onBlur","rest","internalRef","setRef","instance","current","undefined","renderInputComponent","restReactHookFormControlledFieldProps","focus","setComponentRef","onChangeCombined","value","onBlurCombined","event","onFocus","props","field","forwardRef","propTypes","elementType","isRequired","string","bool","object","func"],"sources":["../../source/react-hook-form/ReactHookFormInput.js"],"sourcesContent":["import React, { useRef, useCallback, useImperativeHandle } from 'react'\nimport { Controller } from 'react-hook-form'\nimport PropTypes from 'prop-types'\n\nlet ReactHookFormInput = ({\n  Component,\n  name,\n  defaultValue,\n  shouldUnregister,\n  control,\n  rules,\n  onChange: onChange_,\n  onBlur: onBlur_,\n  ...rest\n}, ref) => {\n  const internalRef = useRef()\n\n  const setRef = useCallback((instance) => {\n    internalRef.current = instance\n    if (ref) {\n      if (typeof ref === 'function') {\n        ref(instance)\n      } else {\n        ref.current = instance\n      }\n    }\n  }, [ref])\n\n  // `feact-hook-form` doesn't know how to properly handle `undefined` values.\n  // https://github.com/react-hook-form/react-hook-form/issues/2990\n  defaultValue = defaultValue === undefined ? null : defaultValue\n\n  const renderInputComponent = ({\n    ref,\n    onChange,\n    onBlur,\n    // `restReactHookFormControlledFieldProps` contain properties like `name` and `value`.\n    // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n    ...restReactHookFormControlledFieldProps\n  }) => {\n    // Setting `ref` passed by `react-hook-form` results in a bug:\n    // when an initial value is defined (example: \"+78005553535\")\n    // it seems to be set directly on the `ref`d `<input/>`\n    // by `react-hook-form` and the result is a non-formatted\n    // \"+78005553535\" initial value in the `<input/>`.\n    //\n    // To work around that bug, a fake `ref` is assigned,\n    // so that it could only `.focus()` it and no more.\n    //\n    // `useImperativeHandle()` hook seems to allow `ref` being `undefined`.\n    //\n    // if (ref) {\n      useImperativeHandle(ref, () => ({\n        focus() {\n          internalRef.current.focus()\n        }\n      }))\n    // }\n\n    const setComponentRef = useCallback((instance) => {\n      setRef(instance)\n      // if (ref) {\n      //   if (typeof ref === 'function') {\n      //     ref(instance)\n      //   } else {\n      //     ref.current = instance\n      //   }\n      // }\n    }, [ref, setRef])\n\n    // This function may not work correctly when `defaultValues` are set for the input\n    // and the user clears the input value manually: the default value may re-appear as a result.\n    // https://github.com/catamphetamine/react-phone-number-input/issues/405#issuecomment-1295885201\n    const onChangeCombined = useCallback((value) => {\n      // `react-hook-form` doesn't know how to properly handle `undefined` values.\n      // https://github.com/react-hook-form/react-hook-form/issues/2990\n      if (value === undefined) {\n        value = null\n      }\n      onChange(value)\n      if (onChange_) {\n        onChange_(value)\n      }\n    }, [\n      onChange,\n      onChange_\n    ])\n\n    const onBlurCombined = useCallback((event) => {\n      onBlur(event)\n      if (onBlur_) {\n        onBlur_(event)\n      }\n    }, [\n      onBlur,\n      onBlur_\n    ])\n\n    return (\n      <Component\n        {...rest}\n        {...restReactHookFormControlledFieldProps}\n        ref={setComponentRef}\n        onChange={onChangeCombined}\n        onBlur={onBlurCombined}/>\n    )\n  }\n\n  // `react-hook-form@7` no longer accepts `onFocus` property.\n  // Since this component can be used with both `v6` and `v7`,\n  // the `onFocus` property is left here.\n  const onFocus = useCallback(() => {\n    // internalRef.current.disabled = false\n    internalRef.current.focus()\n  }, [])\n\n  return (\n    <Controller\n      control={control}\n      name={name}\n      defaultValue={defaultValue}\n      shouldUnregister={shouldUnregister}\n      rules={rules}\n      onFocus={onFocus}\n      render={(props) => {\n        // Differentiate between `react-hook-form@6` and `react-hook-form@7`.\n        // https://react-hook-form.com/migrate-v6-to-v7/\n        // https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/57\n        // `props` (before v7) and `props.fields` (in v7) contain properties like:\n        // `ref`, `name`, `value`, `onChange`, `onBlur`.\n        // https://github.com/react-hook-form/react-hook-form/blob/b0e6c3057ac12a7b12d5616aecf3791acb7d7204/src/types/controller.ts#L21-L30\n        return renderInputComponent(props.field || props)\n      }}/>\n  )\n}\n\nReactHookFormInput = React.forwardRef(ReactHookFormInput)\n\nReactHookFormInput.propTypes = {\n  Component: PropTypes.elementType.isRequired,\n  name: PropTypes.string.isRequired,\n  defaultValue: PropTypes.string,\n  // A quote from `react-hook-form`:\n  // Without `shouldUnregister: true`, an input value would be retained when input is removed.\n  // Setting `shouldUnregister: true` makes the form behave more closer to native.\n  shouldUnregister: PropTypes.bool,\n  control: PropTypes.object.isRequired,\n  rules: PropTypes.object,\n  onChange: PropTypes.func,\n  onBlur: PropTypes.func\n}\n\nexport default ReactHookFormInput"],"mappings":"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"}